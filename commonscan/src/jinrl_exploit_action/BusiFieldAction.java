/*
 * Generated by MyEclipse Struts
 * Template path: templates/java/JavaClass.vtl
 */
package jinrl_exploit_action;

import java.io.IOException;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;
import javax.servlet.http.HttpSession;

import jinrl_exploit_IService.IBusiFieldService;
import org.apache.struts.action.ActionForm;
import org.apache.struts.action.ActionForward;
import org.apache.struts.action.ActionMapping;
import org.apache.struts.actions.DispatchAction;

/**
 * MyEclipse Struts Creation date: 04-16-2010
 *
 * XDoclet definition:
 *
 * @struts.action
 */
public class BusiFieldAction extends DispatchAction {
	IBusiFieldService busiFieldService;

	public void setBusiFieldService(IBusiFieldService busiFieldService) {
		this.busiFieldService = busiFieldService;
	}


	/**
	 * 此方法用在显示列表时
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return ActionForward
	 */
	public ActionForward getBusiInfoid(ActionMapping mapping,
			ActionForm form, HttpServletRequest request,
			HttpServletResponse response) {
		//接收页面传递过来的业务字段表的ID
		String id = request.getParameter("id");
		request.setAttribute("busiFieldID",id);
//		int fid = 0;
//		try {
//			fid = Integer.parseInt(id);
//		} catch (Exception e) {
//			System.out.println("页面传递的业务字段表id不为数字");
//			e.printStackTrace();
//		}
		String datascourceId = busiFieldService.getBusiInfoIdByfid(id);
		request.setAttribute("datascourceId", datascourceId);
		return mapping.findForward("datascourceId");
	}

	/**
	 * 此方法用在显示添加页面时
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return
	 */
	public ActionForward findBusiInfoId(ActionMapping mapping,
			ActionForm form, HttpServletRequest request,
			HttpServletResponse response) {
		//接收页面传递过来的业务字段表的ID
		String id = request.getParameter("id");
		String datascourceId = busiFieldService.getBusiInfoIdByfid(id);
		request.setAttribute("datascourceId", datascourceId);
		return mapping.findForward("showAddDataPage");
	}

	/**
	 * 销毁session
	 * @param mapping
	 * @param form
	 * @param request
	 * @param response
	 * @return
	 */
	public ActionForward quit(ActionMapping mapping,
			ActionForm form, HttpServletRequest request,
			HttpServletResponse response) {
		HttpSession session = request.getSession();

		session.invalidate();
		try {
			response.sendRedirect("/powermodule/checkpower.do?method=quit");
		} catch (IOException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return null;

	}
}