package jinrl_exploit_ServiceImpl;

import jinrl_exploit_ICommonDao.ICommonDao;
import jinrl_exploit_IService.IBusiInfoService;
import jinrl_exploit_Po.TbusiInfo;
import jinrl_exploit_common.DataConnect;

public class BusiInfoServiceImpl implements IBusiInfoService {
	ICommonDao commonDao;

	public void setCommonDao(ICommonDao commonDao) {
		this.commonDao = commonDao;
	}

	public TbusiInfo getBusiInfoByfid(String fid) {
		TbusiInfo datasource = null;
		try {
			datasource = (TbusiInfo) commonDao.getData(
					"from TbusiInfo tb where tb.fid='" + fid+"'").get(0);
		} catch (Exception e) {
			e.printStackTrace();
		}
		return datasource;
	}

	public boolean delteData(TbusiInfo busiInfo, String fid) {
		// 连接数据源中所指定的数据库
		DataConnect dc = new DataConnect(busiInfo.getFconndatabase(), false);
		String tablename = busiInfo.getFtablename();
		try {
			String pkid=busiInfo.getFprimarykey();
			if(null==pkid || "".equals(pkid)){
				pkid="fid";
			}
			int a = dc.execute("delete from " + tablename + " where "+pkid+"='" + fid+"'");
			if(a==-1){
				System.out.println("删除失败 !    tablename:"+tablename+"    fid:"+fid);
				return false;
			}else
			return true;
		} catch (Exception e) {
			System.out.println("删除失败 !    tablename:"+tablename+"    fid:"+fid);
			return false;
		}finally{
			dc.CloseConnect();
		}
	}
}
